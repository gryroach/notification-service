# Проектная работа 10 спринта

## Разработка

### Виртуальное окружение

Для создания виртуального окружения и установки пакетов выполните команду:

```bash
uv sync
```

### Pre-commit хуки

Для установки pre-commit хуков выполните:

```bash
pip install pre-commit
pre-commit install
```

Это установит автоматические проверки кода перед каждым коммитом, включая:
- Проверку форматирования (trailing whitespace, end of file)
- Проверку синтаксиса YAML
- Проверку конфликтов слияния
- Сортировку импортов с помощью isort
- Форматирование и линтинг с помощью ruff
- Проверку типов с помощью mypy

### Миграции

Для создания миграций перейдите в директорию notification_service:
```bash
cd notification_service/ 
```

Пропишите PYTHONPATH:
```bash
export PYTHONPATH=./src
```

Создание миграции:
```bash
alembic revision --autogenerate -m "002_your_name"
```

Важно не забывать про нумерацию миграций для простоты отслеживания изменений.

Применение миграций:
```bash
alembic upgrade head
```
Если запуск проекта происходит в докере, то может быть проблема с подключением к БД. 
Чтобы ее решить, необходимо поменять переменные окружения `NOTIFY_POSTGRES_HOST` и
`NOTIFY_POSTGRES_PORT` на `localhost` и соответствующий порт.

## Выполнение запросов

Документация swagger находится по адресу http://127.0.0.1/api-notify/openapi

Для выполнения некоторых запросов необходимо быть авторизованным пользователем.
Для генерации access-токена можно использовать python-скрипт:

```bash
python tools/generate_token.py
```
